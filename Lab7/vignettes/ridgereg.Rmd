---
title: "Ridge Regression"
author: "Rasmus Holm"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Ridge Regression}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r}
suppressMessages(library(mlbench))
suppressMessages(library(caret))
suppressMessages(library(elasticnet))
suppressMessages(library(leaps))

data(BostonHousing)

## Data Processing
set.seed(123)
train_idx <- createDataPartition(BostonHousing$crim, p=0.80, list=FALSE)

training <- BostonHousing[train_idx,]
testing <- BostonHousing[-train_idx,]

## Linear Regression
lm.fit <- train(crim ~ ., data=training, method="lm", preProc=c("center", "scale"))
lm.fit

lm.train_predict <- predict(lm.fit, newdata=training)
training_mse <- mean((training$crim - lm.train_predict)^2)
training_mse

lm.test_predict <- predict(lm.fit, newdata=testing)
testing_mse <- mean((testing$crim - lm.test_predict)^2)
testing_mse

## Linear Regression Forward Selection
lmfs.fit <- train(crim ~ ., data=training, method="leapForward", tuneLength=12, preProc=c("center", "scale"))
lmfs.fit

lmfs.train_predict <- predict(lmfs.fit, newdata=training)
training_mse <- mean((training$crim - lmfs.train_predict)^2)
training_mse

lmfs.test_predict <- predict(lmfs.fit, newdata=testing)
testing_mse <- mean((testing$crim - lmfs.test_predict)^2)
testing_mse

## Ridge Regressions (Should use our own implementation)
train_control <- trainControl(method="cv", number=10)

ridge.fit <- train(crim ~ ., data=training, method="ridge",
                  trControl=train_control, tuneLength=12, preProc=c("center", "scale"))
ridge.fit

ridge.train_predict <- predict(ridge.fit, newdata=training)
training_mse <- mean((training$crim - ridge.train_predict)^2)
training_mse

ridge.test_predict <- predict(ridge.fit, newdata=testing)
testing_mse <- mean((testing$crim - ridge.test_predict)^2)
testing_mse
```
